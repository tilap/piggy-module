{"version":3,"sources":["Storage/Db.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;wBAA4B,YAAY;;;;sBACX,aAAa;;uBACjB,SAAS;;IAEb,OAAO;YAAP,OAAO;;AAEf,WAFQ,OAAO,CAEd,UAAU,EAAE;0BAFL,OAAO;;AAGxB,+BAHiB,OAAO,6CAGlB,UAAU,EAAE;GACnB;;eAJkB,OAAO;;WAMvB,eAA6B;;;UAA5B,QAAQ,yDAAG,EAAE;UAAE,OAAO,yDAAE,EAAE;;AAC5B,UAAG,QAAQ,CAAC,GAAG,EAAE;AACf,gBAAQ,CAAC,GAAG,GAAG,aAVZ,QAAQ,EAUa,QAAQ,CAAC,GAAG,CAAC,CAAC;OACvC;AACD,aAAO,IAAI,OAAO,CAAE,UAAC,OAAO,EAAE,MAAM,EAAK;AACvC,cAAK,UAAU,CACZ,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CACvB,OAAO,CAAE,UAAC,GAAG,EAAE,KAAK,EAAK;AACxB,cAAG,GAAG,EAAE;AACN,mBAAO,MAAM,CAAC,GAAG,CAAC,CAAC;WACpB;AACD,iBAAO,CAAC,KAAK,CAAC,CAAC;SAChB,CAAC,CAAC;OACN,CAAC,CAAC;KACJ;;;WAEK,gBAAC,MAAM,EAAE;;;AACb,aAAO,IAAI,OAAO,CAAE,UAAC,OAAO,EAAE,MAAM,EAAK;AACvC,eAAK,UAAU,CAAC,MAAM,CAAC,MAAM,EAAE,UAAC,GAAG,EAAE,OAAO,EAAK;AAC/C,cAAG,GAAG,EAAE;AACN,mBAAO,MAAM,CAAC,GAAG,CAAC,CAAC;WACpB,MACI,IAAG,CAAC,OAAO,EAAE;AAChB,mBAAO,MAAM,CAAE,YAhChB,YAAY,CAgCqB,qCAAqC,CAAC,CAAE,CAAC;WAC1E,MACI;AACH,mBAAO,CAAC,OAAO,CAAC,CAAC;WAClB;SACF,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ;;;WAEK,gBAAC,QAAQ,EAAE,SAAS,EAAE;;;AAC1B,aAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,EAAE,SAAS,EAAE,UAAC,GAAG,EAAK;AAC1D,YAAG,GAAG,EAAE;AACN,iBAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;SAC5B;AACD,eAAO,OAAK,GAAG,CAAC,QAAQ,CAAC,CAAC;OAC3B,CAAC,CAAC;KACJ;;;WAEK,iBAAC,QAAQ,EAAE;;;AACf,aAAO,IAAI,OAAO,CAAE,UAAC,OAAO,EAAE,MAAM,EAAK;AACvC,eAAK,UAAU,CAAC,MAAM,CAAC,QAAQ,EAAE,UAAC,GAAG,EAAE,cAAc,EAAK;AACxD,cAAG,GAAG,EAAE;AACN,mBAAO,MAAM,CAAC,GAAG,CAAC,CAAC;WACpB;AACD,iBAAO,CAAC,cAAc,CAAC,CAAC;SACzB,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ;;;SAxDkB,OAAO;;;qBAAP,OAAO","file":"Storage/Db.js","sourcesContent":["import AbstractStorage from './Abstract';\nimport { StorageError } from './../Errors';\nimport { ObjectId } from 'mongodb';\n\nexport default class Storage extends AbstractStorage{\n\n  constructor(collection) {\n    super(collection);\n  }\n\n  get(criteria = {}, options= {}) {\n    if(criteria._id) {\n      criteria._id = ObjectId(criteria._id);\n    }\n    return new Promise( (resolve, reject) => {\n      this.collection\n        .find(criteria, options)\n        .toArray( (err, items) => {\n          if(err) {\n            return reject(err);\n          }\n          resolve(items);\n        });\n    });\n  }\n\n  insert(voData) {\n    return new Promise( (resolve, reject) => {\n      this.collection.insert(voData, (err, newItem) => {\n        if(err) {\n          return reject(err);\n        }\n        else if(!newItem) {\n          return reject( new StorageError('Error while inserting (no new item)') );\n        }\n        else {\n          resolve(newItem);\n        }\n      });\n    });\n  }\n\n  update(criteria, newVoData) {\n    return this.collection.update(criteria, newVoData, (err) => {\n      if(err) {\n        return Promise.reject(err);\n      }\n      return this.get(criteria);\n    });\n  }\n\n  delete(criteria) {\n    return new Promise( (resolve, reject) => {\n      this.collection.remove(criteria, (err, deleteRowCount) => {\n        if(err) {\n          return reject(err);\n        }\n        resolve(deleteRowCount);\n      });\n    });\n  }\n}\n"],"sourceRoot":"/source/"}