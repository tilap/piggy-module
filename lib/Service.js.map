{"version":3,"sources":["Service.js"],"names":[],"mappings":"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","file":"Service.js","sourcesContent":["export default class Service {\n\n  constructor(manager) {\n    this._manager = manager;\n    this._context = {};\n  }\n\n  setContext(key, value) {\n    this._context[key]=value;\n  }\n\n  setFullContext(context) {\n    this._context = context;\n  }\n\n  createOneFromData(data) {\n    let vo = this._manager.getNewVo(data);\n    return new Promise((resolve, reject) => {\n      this._manager.saveOne(vo)\n        .catch(err => {\n          return reject(err);\n        })\n        .then(user => {\n          return resolve(user);\n        });\n    });\n  }\n\n  get(criteria={}, options={}) {\n    return this._manager.get(criteria, options);\n  }\n\n  getByPage(criteria, page=1, limit=15, orderby='id', order=1) {\n    page = page > 0 ? page : 1;\n    order = (order==='desc' || order===false || order===-1 || order==='-1') ? 'desc' : 'asc';\n    let options = {};\n    options.limit = limit;\n    options.skip = (page-1) * limit;\n    options.sort = [[orderby, order]];\n    return this.get(criteria, options);\n  }\n\n  getOneById(id) {\n    return this._manager.getOneById(id);\n  }\n\n  updateOneFromData(data, id) {\n    return new Promise((resolve, reject) => {\n      this.getOneById(id).then( vo => {\n        if(null===vo) {\n          return reject ('not found');\n        }\n        vo.setData(data);\n        return vo;\n      })\n      .then( vo => {\n        this._manager.saveOne(vo).then( vo => {\n          return resolve(vo);\n        })\n        .catch(err => {\n          return reject(err);\n        });\n      });\n    });\n  }\n\n  deleteOneById(id) {\n    return new Promise((resolve, reject) => {\n      this.getOneById(id).then( vo => {\n        if(null===vo) {\n          return resolve(null);\n        }\n        this._manager.deleteOne(vo).then( success => {\n          return resolve(success===true);\n        });\n      });\n    });\n  }\n\n  get availableMethods() {\n    let childMethods = Object.getOwnPropertyNames(this.__proto__);\n    let OwnMethods = Object.getOwnPropertyNames(Service.prototype);\n\n    let methods = childMethods;\n    OwnMethods.forEach( method => {\n      if(methods.indexOf(method) < 0) {\n        methods.push(method);\n      }\n    });\n    return methods;\n  }\n}\n"],"sourceRoot":"/source/"}